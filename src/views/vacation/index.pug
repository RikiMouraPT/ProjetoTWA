extends ../layouts/app

block content
  div.flex.justify-between.items-center.mb-6
    h1.text-2xl.font-bold.text-gray-900 Gestão de Departamento
    
    // Link rápido para o manager ver as suas próprias férias
    a(href=`/vacations/byUser/${user.id}`).text-blue-600
      | Ver as minhas férias &rarr;

  // --- FILTROS ---
  div.mb-6.flex.space-x-2
  
    a(href="/vacations" class=`px-4 py-2 rounded-md text-sm font-medium border transition ${!currentFilter ? 'bg-gray-800 text-white border-gray-800' : 'bg-white text-gray-700 border-gray-300 hover:bg-gray-50'}`) 
      | Todos do Departamento
    
    a(href="/vacations?filter=pending" class=`px-4 py-2 rounded-md text-sm font-medium border transition ${currentFilter == 'pending' ? 'bg-yellow-100 text-yellow-800 border-yellow-300 ring-1 ring-yellow-300' : 'bg-white text-gray-700 border-gray-300 hover:bg-gray-50'}`) 
      | Pendentes

  // --- TABELA ---
  div.bg-white.shadow.overflow-hidden.border.border-gray-200.rounded-lg
    if vacations.length > 0
      table.min-w-full.divide-y.divide-gray-200
        thead.bg-gray-50
          tr
            th.px-6.py-3.text-left.text-xs.font-bold.text-gray-500.uppercase ID
            th.px-6.py-3.text-left.text-xs.font-bold.text-gray-500.uppercase Colaborador
            th.px-6.py-3.text-left.text-xs.font-bold.text-gray-500.uppercase Tipo
            th.px-6.py-3.text-left.text-xs.font-bold.text-gray-500.uppercase Datas
            th.px-6.py-3.text-left.text-xs.font-bold.text-gray-500.uppercase Estado
            th.px-6.py-3.text-right.text-xs.font-bold.text-gray-500.uppercase Ações
        
        tbody.bg-white.divide-y.divide-gray-200
          each v in vacations
            tr
              td.px-6.py-4.whitespace-nowrap.text-sm.text-gray-500 ##{v.id}
              
              td.px-6.py-4.whitespace-nowrap.text-sm.font-medium.text-gray-900 
                div #{v.user_name}
                div.text-xs.text-gray-400 ID: #{v.user_id}
              
              td.px-6.py-4.whitespace-nowrap.text-sm.text-gray-500 #{v.leave_type_name}
              
              td.px-6.py-4.whitespace-nowrap.text-sm.text-gray-500
                div De: #{new Date(v.start_date).toLocaleDateString()}
                div Até: #{new Date(v.end_date).toLocaleDateString()}
              
              td.px-6.py-4.whitespace-nowrap
                if v.status == 'approved'
                  span.px-2.py-1.text-xs.font-bold.rounded-full.bg-green-100.text-green-800 Aprovado
                else if v.status == 'rejected'
                  span.px-2.py-1.text-xs.font-bold.rounded-full.bg-red-100.text-red-800 Rejeitado
                else
                  span.px-2.py-1.text-xs.font-bold.rounded-full.bg-yellow-100.text-yellow-800 Pendente
              
              td.px-6.py-4.whitespace-nowrap.text-right.text-sm.font-medium
                if v.status == "pending"
                  form(action=`/vacations/${v.id}/accept?_method=PUT` method="POST" class="inline-block mr-2")
                    button(type="submit" class="text-green-600 hover:text-green-900 font-bold" title="Aprovar")
                      i.fa-solid.fa-check
                  
                  form(action=`/vacations/${v.id}/reject?_method=PUT` method="POST" class="inline-block")
                    button(type="submit" class="text-red-600 hover:text-red-900 font-bold" title="Rejeitar")
                      i.fa-solid.fa-xmark
                else
                  span.text-gray-400 -
    else
      div.p-12.text-center
        p.text-gray-500 Não existem pedidos para este filtro.